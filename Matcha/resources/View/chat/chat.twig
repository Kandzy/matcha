{% extends 'layout/app.twig' %}

{% block title %}Chat{% endblock %}

{% block content %}
    <div id='nameofuser'>{{ data.Login }}</div>
        <input type="hidden" id='hidden' value={{ data.Login }}>
        <input type="text" name="message" id='message' onkeypress="if(event.keyCode === 13){sendMessage();}">
        <button id='btn'>Send</button>
    {#<p id='login'>{{ data.Login }}</p>#}
    <script>
        var message = document.getElementById('message');
        var btn = document.getElementById('btn')
        var login = document.getElementById('hidden').value;
        var conn = new WebSocket('ws://localhost:8101');
        conn.onopen = function (e) {
            console.log('Connection established!');
        };

        conn.onmessage = function (e) {
            console.log(e.data);
            var chat = document.getElementById('chat');
            chat.innerHTML += e.data + "<br>";
        };
        btn.onclick = function () {
            sendMessage();
        }
        function sendMessage() {
            var msg = message.value;
            message.value = '';
            conn.send(login + ' : ' + msg);
        }
    </script>
    <div id='chat'>

    </div>
{% endblock %}